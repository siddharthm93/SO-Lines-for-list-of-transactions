SELECT SO.NUM AS "SONUM", 
      REPLACE(CUSTOMER.NAME, ',', 'COMMAESCAPE') AS "CUSTOMER",
      SOITEM.SOLINEITEM AS "LINE",
      PART.NUM AS "PARTNUM", 
      REPLACE(PART.DESCRIPTION, ',', 'COMMAESCAPE') AS "DESCRIPTION", 
      (SOITEM.QTYTOFULFILL - SOITEM.QTYFULFILLED) AS "QTY", 
      SOITEMSTATUS.NAME AS "STATUS", 
      SOITEM.DATESCHEDULEDFULFILLMENT AS "DATE",
      SO.DATEISSUED AS "DATEISSUED",
      CS3.INFO AS "CUSTOMER DELIVERY REQUEST",
      SO.CUSTOMERPO AS "CUSTOMER PO",
      REPLACE(SOITEM.NOTE, ',', 'COMMAESCAPE') AS "NOTE",
      LOCATIONGROUP.NAME AS "GROUP",
      CS4.INFO AS "WAREHOUSE",
      CSMAKEBUY.INFO AS "MAKEBUY"

FROM SO JOIN CUSTOMER ON SO.CUSTOMERID = CUSTOMER.ID
       JOIN SOITEM ON SO.ID = SOITEM.SOID
       JOIN PRODUCT ON SOITEM.PRODUCTID = PRODUCT.ID
       JOIN PART ON PRODUCT.PARTID = PART.ID
       JOIN CUSTOMSET ON PART.ID = CUSTOMSET.RECORDID
       JOIN SOITEMSTATUS ON SOITEM.STATUSID = SOITEMSTATUS.ID
       JOIN LOCATIONGROUP ON SO.LOCATIONGROUPID = LOCATIONGROUP.ID
       LEFT JOIN (SELECT * 
                  FROM CUSTOMSET 
                  WHERE CUSTOMSET.CUSTOMFIELDID = 80)
            AS CS2 ON CS2.RECORDID = PART.ID
       LEFT JOIN (SELECT *
                  FROM CUSTOMTIMESTAMP
                  WHERE CUSTOMTIMESTAMP.CUSTOMFIELDID = 112)
            AS CS3 ON CS3.RECORDID = SO.ID
       LEFT JOIN (SELECT *
                  FROM CUSTOMSET
                  WHERE CUSTOMSET.CUSTOMFIELDID = 110)
            AS CS4 ON CS4.RECORDID = SOITEM.ID
       LEFT JOIN (SELECT *
                  FROM CUSTOMSET 
                  WHERE CUSTOMSET.CUSTOMFIELDID = 64)
            AS CSMAKEBUY ON CSMAKEBUY.RECORDID = PART.ID

            
WHERE SO.STATUSID IN(20,25)
 AND CUSTOMSET.CUSTOMFIELDID = 64
 AND SOITEM.STATUSID < 50
 AND SOITEM.TYPEID = 10
 AND PART.NUM NOT IN("ENGINEERING LABOR","DC LABOR","SUB-CONTRACTOR LABOR")
 AND LOCATIONGROUP.NAME != 'WA INSIDE SALES'
 AND LOCATIONGROUP.NAME != 'WA RMA'

ORDER BY SO.DATEISSUED, SOITEM.SOLINEITEM